import { MigrationInterface, QueryRunner } from 'typeorm';
import { State } from '../src/countries/states/state.entity';
import { Country } from '../src/countries/country.entity';

export class InsertStates1577280082873 implements MigrationInterface {

  public async up(queryRunner: QueryRunner): Promise<any> {

    const statesJSON = `{"182":[{"id":1833,"name":"Primorsky Krai","countryId":182},{"id":1834,"name":"Novgorod Oblast","countryId":182},{"id":1835,"name":"Jewish Autonomous Oblast","countryId":182},{"id":1836,"name":"Nenets Autonomous Okrug","countryId":182},{"id":1837,"name":"Rostov Oblast","isActive": true,"countryId":182},{"id":1838,"name":"Khanty-Mansi Autonomous Okrug","countryId":182},{"id":1839,"name":"Magadan Oblast","countryId":182},{"id":1840,"name":"Krasnoyarsk Krai","countryId":182},{"id":1841,"name":"Republic of Karelia","countryId":182},{"id":1842,"name":"Republic of Buryatia","countryId":182},{"id":1843,"name":"Murmansk Oblast","countryId":182},{"id":1844,"name":"Kaluga Oblast","countryId":182},{"id":1845,"name":"Chelyabinsk Oblast","countryId":182},{"id":1846,"name":"Omsk Oblast","countryId":182},{"id":1847,"name":"Yamalo-Nenets Autonomous Okrug","countryId":182},{"id":1848,"name":"Sakha Republic","countryId":182},{"id":1849,"name":"Arkhangelsk","countryId":182},{"id":1850,"name":"Republic of Dagestan","countryId":182},{"id":1851,"name":"Yaroslavl Oblast","countryId":182},{"id":1852,"name":"Republic of Adygea","countryId":182},{"id":1853,"name":"Republic of North Ossetia-Alania","countryId":182},{"id":1854,"name":"Republic of Bashkortostan","countryId":182},{"id":1855,"name":"Kursk Oblast","countryId":182},{"id":1856,"name":"Ulyanovsk Oblast","countryId":182},{"id":1857,"name":"Nizhny Novgorod Oblast","countryId":182},{"id":1858,"name":"Amur Oblast","countryId":182},{"id":1859,"name":"Chukotka Autonomous Okrug","countryId":182},{"id":1860,"name":"Tver Oblast","countryId":182},{"id":1861,"name":"Republic of Tatarstan","countryId":182},{"id":1862,"name":"Samara Oblast","countryId":182},{"id":1863,"name":"Pskov Oblast","countryId":182},{"id":1864,"name":"Ivanovo Oblast","countryId":182},{"id":1865,"name":"Kamchatka Krai","countryId":182},{"id":1866,"name":"Astrakhan Oblast","countryId":182},{"id":1867,"name":"Bryansk Oblast","countryId":182},{"id":1868,"name":"Stavropol Krai","countryId":182},{"id":1869,"name":"Karachay-Cherkess Republic","countryId":182},{"id":1870,"name":"Mari El Republic","countryId":182},{"id":1871,"name":"Perm Krai","countryId":182},{"id":1872,"name":"Tomsk Oblast","countryId":182},{"id":1873,"name":"Khabarovsk Krai","countryId":182},{"id":1874,"name":"Vologda Oblast","countryId":182},{"id":1875,"name":"Sakhalin","countryId":182},{"id":1876,"name":"Altai Republic","countryId":182},{"id":1877,"name":"Republic of Khakassia","countryId":182},{"id":1878,"name":"Tambov Oblast","countryId":182},{"id":1879,"name":"Saint Petersburg","isActive": true,"countryId":182},{"id":1880,"name":"Irkutsk","countryId":182},{"id":1881,"name":"Vladimir Oblast","countryId":182},{"id":1882,"name":"Moscow Oblast","isActive": true,"countryId":182},{"id":1883,"name":"Republic of Kalmykia","countryId":182},{"id":1884,"name":"Republic of Ingushetia","countryId":182},{"id":1885,"name":"Smolensk Oblast","countryId":182},{"id":1886,"name":"Orenburg Oblast","countryId":182},{"id":1887,"name":"Saratov Oblast","countryId":182},{"id":1888,"name":"Novosibirsk","countryId":182},{"id":1889,"name":"Lipetsk Oblast","countryId":182},{"id":1890,"name":"Kirov Oblast","countryId":182},{"id":1891,"name":"Krasnodar Krai","isActive": true,"countryId":182},{"id":1892,"name":"Kabardino-Balkar Republic","countryId":182},{"id":1893,"name":"Chechen Republic","countryId":182},{"id":1894,"name":"Sverdlovsk","countryId":182},{"id":1895,"name":"Tula Oblast","countryId":182},{"id":1896,"name":"Leningrad Oblast","countryId":182},{"id":1897,"name":"Kemerovo Oblast","countryId":182},{"id":1898,"name":"Republic of Mordovia","countryId":182},{"id":1899,"name":"Komi Republic","countryId":182},{"id":1900,"name":"Tuva Republic","countryId":182},{"id":1901,"name":"Moscow","countryId":182},{"id":1902,"name":"Kaliningrad","countryId":182},{"id":1903,"name":"Belgorod Oblast","countryId":182},{"id":1904,"name":"Zabaykalsky Krai","countryId":182},{"id":1905,"name":"Ryazan Oblast","countryId":182},{"id":1906,"name":"Voronezh Oblast","isActive": true,"countryId":182},{"id":1907,"name":"Tyumen Oblast","countryId":182},{"id":1908,"name":"Oryol Oblast","countryId":182},{"id":1909,"name":"Penza Oblast","countryId":182},{"id":1910,"name":"Kostroma Oblast","countryId":182},{"id":1911,"name":"Altai Krai","countryId":182},{"id":1912,"name":"Sevastopol","isActive": true,"countryId":182},{"id":1913,"name":"Udmurt Republic","countryId":182},{"id":1914,"name":"Chuvash Republic","countryId":182},{"id":1915,"name":"Kurgan Oblast","countryId":182}],"230":[{"id":4668,"name":"Zhytomyr Oblast","countryId":230},{"id":4669,"name":"Vinnytsia Oblast","countryId":230},{"id":4670,"name":"Zakarpattia Oblast","countryId":230},{"id":4671,"name":"Kyiv Oblast","isActive": true,"countryId":230},{"id":4672,"name":"Lviv Oblast","isActive": true,"countryId":230},{"id":4673,"name":"Luhansk Oblast","countryId":230},{"id":4674,"name":"Ternopil Oblast","countryId":230},{"id":4675,"name":"Dnipropetrovsk Oblast","isActive": true,"countryId":230},{"id":4676,"name":"Kiev","isActive": true,"countryId":230},{"id":4677,"name":"Kirovohrad Oblast","countryId":230},{"id":4678,"name":"Chernivtsi Oblast","countryId":230},{"id":4679,"name":"Mykolaiv Oblast","countryId":230},{"id":4680,"name":"Cherkasy Oblast","countryId":230},{"id":4681,"name":"Khmelnytsky Oblast","countryId":230},{"id":4682,"name":"Ivano-Frankivsk Oblast","countryId":230},{"id":4683,"name":"Rivne Oblast","countryId":230},{"id":4684,"name":"Kherson Oblast","countryId":230},{"id":4685,"name":"Sumy Oblast","countryId":230},{"id":4686,"name":"Kharkiv Oblast","isActive": true,"countryId":230},{"id":4687,"name":"Zaporizhzhya Oblast","countryId":230},{"id":4688,"name":"Odessa Oblast","countryId":230},{"id":4689,"name":"Autonomous Republic of Crimea","countryId":230},{"id":4690,"name":"Volyn Oblast","countryId":230},{"id":4691,"name":"Donetsk Oblast","countryId":230},{"id":4692,"name":"Chernihiv Oblast","countryId":230}]}`;
    const states = JSON.parse(statesJSON);
    const keys = Object.keys(states);
    for (const property of keys) {
      const country = await queryRunner.manager.findOne(Country, property);
      const array = states[property].map(el => {
        el.country = country;
        return el;
      });
      await queryRunner.manager.insert(State, array);
    }
  }

  public async down(queryRunner: QueryRunner): Promise<any> {
    console.log('__1__', {  });
    const repository = await queryRunner.manager.getRepository(State);
    console.log('__s__', {  });
    await repository.clear();
  }
}
